const mysql=require("mysql");const MysqlData=require("../../models/MysqlData");const connection=mysql.createConnection((new MysqlData).getConnection());const Aes256=require("../../lib/Aes256");module.exports=class CheckPostOwner{constructor(postId,userId){this.postId=postId;this.userId=userId}check(){return new Promise(resolve=>{connection.query("SELECT COUNT(1) count\n"+"FROM `posts`\n"+"WHERE `author`=(\n"+"    SELECT `index`\n"+"        FROM `accounts`\n"+"        WHERE `id`=?\n"+") AND `index`=?;",[new Aes256(this.userId,"plain").getEncrypted(),this.postId],(error,result,fields)=>{if(error){throw error}resolve(!!result[0].count)})})}};