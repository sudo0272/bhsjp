const mysql=require("mysql");const MysqlData=require("../../models/MysqlData");const connection=mysql.createConnection((new MysqlData).getConnection());const postListItemCount=20;module.exports=class ReadPostList{constructor(offset){this.offset=offset}count(){return new Promise(resolve=>{connection.query("SELECT COUNT(1) count\n"+"FROM `posts`;",(error,result,fields)=>{if(error){throw error}else{resolve(result[0].count)}})})}list(){return new Promise((resolve,reject)=>{connection.query("SELECT p.`index`, p.`title`, p.`password`\n"+"FROM `posts` p\n"+"LEFT JOIN `accounts` a\n"+"ON p.`author`=a.`index`\n"+"ORDER BY p.`index` DESC\n"+"LIMIT ?, ?",[this.offset*postListItemCount,postListItemCount],(error,result,fields)=>{if(error){throw error}else{if(result.length>0){resolve(result)}else{reject("no-row")}}})})}};